@using UsersDiosna.Handlers
@model List<AlarmHelper.alarm>


@{
    ViewBag.Title = "Alarms";
    int pageLess = ViewBag.page-1;
    int pageMore = ViewBag.page+1;
}
<h4>Alarms</h4>
<p>
    @if (pageLess >= 0)
    {
        <a class="btn-sm btn-primary" href="/Alarm/Page/@pageLess">&lArr;</a>
    }
    Page: @ViewBag.page 
    <a class="btn-sm btn-primary" href="/Alarm/Page/@pageMore">&rArr;</a>
</p>
<table class="table table-striped table-bordered table-condensed table-hover">
    <tr>
        <th>Id</th>
        <th>Name of alarm</th>
        <th>Origin</th>
        <th>Expiry</th>
    </tr>
    @for (int i = 0; i < Model.Count; i++)
    { 
        <tr>
            <td>@Model[i].id</td>
            <td>@Model[i].title</td>
            <td id="date_@i">@Model[i].originTime</td>
            <td id="expDate_@i">@Model[i].expiryTime</td>
        </tr>
    }
</table>
<p class="left">
    <a class="btn btn-default" href="/AlarmNotification/All?name=@Request.QueryString["name"]&plc=@Request.QueryString["plc"]">Notification from all alarms</a>
</p>
<script>
        function DateTime(date){
                var d = new Date(date);
                var offset = d.getTimezoneOffset();
                var offseted_miliseconds = d.getTime() - (offset*60000);
                var DateTime = new Date(offseted_miliseconds);
                var localDateTime = DateTime.toLocaleString();
                console.log(date);
                console.log(localDateTime);
                return localDateTime;
            }
</script>
@for (int i = 0; i < Model.Count; i++)
{
    <script>
            var date = "@Model[i].originTime";
            var expDate = "@Model[i].expiryTime";

            var localDateTime = DateTime(date);
            document.getElementById("date_" + "@i").innerHTML = localDateTime;
            var localExpDateTime = DateTime(expDate);
            document.getElementById("expDate_" + "@i").innerHTML = localExpDateTime;
    </script>
}
@*<p class="right">
    <a class="btn btn-default" href="/Alarm/Filter?name=@Request.QueryString["name"]&plc=@Request.QueryString["plc"]">Filter from all alarms</a>
</p>*@